-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- ๐ SCRIPT: Verificar Campo Unit - Kilogramo
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- Propรณsito: Verificar que el campo unit se actualiza correctamente

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 1. VERIFICAR PRODUCTO QUESO MANTECOSO
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  '๐ PRODUCTO QUESO MANTECOSO' as seccion,
  id,
  name,
  unit,
  salesunitid,
  purchaseunitid,
  type
FROM "Product"
WHERE name ILIKE '%QUESO MANTECOSO%'
ORDER BY id;

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 2. VERIFICAR TODOS LOS PRODUCTOS CON UNIDADES
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  '๐ TODOS LOS PRODUCTOS CON UNIDADES' as seccion,
  id,
  name,
  unit,
  salesunitid,
  purchaseunitid,
  type
FROM "Product"
WHERE unit IS NOT NULL AND unit != ''
ORDER BY name
LIMIT 20;

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 3. VERIFICAR DISTRIBUCIรN DE UNIDADES
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  '๐ DISTRIBUCIรN DE UNIDADES' as seccion,
  unit,
  COUNT(*) as cantidad
FROM "Product"
WHERE unit IS NOT NULL AND unit != ''
GROUP BY unit
ORDER BY cantidad DESC;

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 4. VERIFICAR PRODUCTOS CON KILOGRAMO
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  'โ๏ธ PRODUCTOS CON KILOGRAMO' as seccion,
  id,
  name,
  unit,
  salesunitid,
  purchaseunitid,
  type
FROM "Product"
WHERE unit ILIKE '%kilo%' OR unit ILIKE '%kg%'
ORDER BY name;

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 5. VERIFICAR PRODUCTOS CON PIEZA
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  '๐ฆ PRODUCTOS CON PIEZA' as seccion,
  id,
  name,
  unit,
  salesunitid,
  purchaseunitid,
  type
FROM "Product"
WHERE unit ILIKE '%pieza%' OR unit ILIKE '%und%'
ORDER BY name
LIMIT 10;

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 6. VERIFICAR PRODUCTOS SIN UNIDAD
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  'โ๏ธ PRODUCTOS SIN UNIDAD' as seccion,
  COUNT(*) as cantidad
FROM "Product"
WHERE unit IS NULL OR unit = '';

-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- 7. VERIFICAR CONSISTENCIA ENTRE UNIT Y SALESUNITID
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SELECT 
  '๐ CONSISTENCIA UNIT vs SALESUNITID' as seccion,
  unit,
  salesunitid,
  COUNT(*) as cantidad
FROM "Product"
WHERE unit IS NOT NULL AND unit != '' AND salesunitid IS NOT NULL
GROUP BY unit, salesunitid
ORDER BY unit, salesunitid; 